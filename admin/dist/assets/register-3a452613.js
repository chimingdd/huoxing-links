import{d as H,r as n,c as I,Q as r,I as l,u as f,v as F,ag as p,aq as W,o as c,J as B,H as b,W as z,M as y,L as G,a as J}from"./@vue-d872a633.js";import{u as Q,a as j}from"./vue-router-154b9487.js";import{u as R}from"./propData-8a0097e5.js";import{c as v,v as K,A as O,b as X,_ as Y}from"./index-eb0483c8.js";import{u as Z}from"./@vueuse-9028f0e6.js";import{i as P}from"./imageCaptcha-8e2c708e.js";import ee from"./PayButton-0b1f9e9b.js";import{E as V}from"./element-plus-baf202ae.js";import"./pinia-cb4be529.js";import"./vue-demi-71ba0ef2.js";import"./pinia-plugin-persistedstate-ed167f96.js";import"./axios-439bb627.js";import"./qs-6612e700.js";import"./side-channel-32a248f0.js";import"./es-errors-c75f5a96.js";import"./object-inspect-110ff94a.js";import"./call-bind-apply-helpers-be8cb158.js";import"./function-bind-48f717dc.js";import"./side-channel-list-1667605c.js";import"./side-channel-map-a9d6574a.js";import"./get-intrinsic-8d8987ad.js";import"./es-object-atoms-11ea1ab9.js";import"./math-intrinsics-9389030e.js";import"./gopd-30775706.js";import"./es-define-property-27915812.js";import"./has-symbols-76fb15e9.js";import"./get-proto-15e8f36b.js";import"./dunder-proto-2a4d8230.js";import"./hasown-31deb62f.js";import"./call-bound-dbfc98a1.js";import"./side-channel-weakmap-a7bef06b.js";import"./@element-plus-11e7d0b3.js";import"./nprogress-72cfee09.js";/* empty css                    */import"./lodash-es-32f1e46b.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-f13f0179.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-5ec34e26.js";import"./qrcode.vue-0c314330.js";const oe={class:"reg-footer"},te=H({__name:"register",props:{visible:{type:Boolean},close_btn:{type:Boolean}},emits:["update:visible"],setup($,{emit:q}){const A=q,h=$;Z();const m=R(()=>h.visible,!1),D=R(()=>h.close_btn,!1),C=n(),d=n(!1),o=n({phone:"",password:"",confirmPassword:"",authCode:"",agent:""}),g=n(/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/),u=n("邮箱");v.verify_code_is_open===1&&(g.value=v.code_mode===1?/^1\d{10}$/:/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/,u.value=v.code_mode===1?"手机号":"邮箱");const T={phone:[{required:!0,message:`请输入${u.value}`,trigger:"blur"},{pattern:g.value,message:`请输入正确的${u.value}`,trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:16,message:"长度在 6 到 16 个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:(w,e,a)=>{e!==o.value.password?a(new Error("两次输入密码不一致")):a()},trigger:"blur"}],authCode:[{required:!0,message:"请输入验证码",trigger:"blur"}],agent:[{required:!0,message:"请选择代理类型",trigger:"blur"}]},_=n(!1),M=async w=>{if(!g.value.test(o.value.phone))return V.error(`请输入正确的${u.value}！`);const e=w.target;P.show(function(a){P.hide(),X({tel:o.value.phone,captcha:a.code,key:a.key}).then(()=>{_.value=!0,V.success("发送成功");const i=function(){let s=e.getAttribute("data-time");s<=0&&(s=60),s--,e.innerHTML=s+"秒后重新获取",e.setAttribute("data-time",s),s>0?setTimeout(i,1e3):(_.value=!1,e.innerHTML="发送验证码")};i()})})},U=Q(),k=j(),E=n(),L=()=>{K(C.value).then(()=>{d.value=!0,O({username:o.value.phone,captcha:o.value.authCode,password:o.value.password,password_confirmation:o.value.confirmPassword,agent_id:o.value.agent,referral_code:U.query.code}).then(()=>{V.success("注册成功，请登录"),localStorage.setItem("register","register"),m.value=!1,k.push("/login")}).finally(()=>{d.value=!1})})};return(w,e)=>{const a=p("el-input"),i=p("el-form-item"),s=p("el-button"),N=p("el-form"),S=p("el-drawer"),x=W("loading");return c(),I("div",null,[r(S,{modelValue:f(m),"onUpdate:modelValue":e[6]||(e[6]=t=>F(m)?m.value=t:null),class:"register_drawer",modal:!1,title:"注册账号","show-close":!f(D),onClose:e[7]||(e[7]=t=>A("update:visible",!1))},{default:l(()=>[B((c(),b(N,{ref_key:"formRef",ref:C,model:o.value,rules:T,"label-position":"left","label-width":"80px"},{default:l(()=>[r(i,{prop:"phone",label:u.value},{default:l(()=>[r(a,{modelValue:o.value.phone,"onUpdate:modelValue":e[0]||(e[0]=t=>o.value.phone=t),placeholder:"请输入"+u.value},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(i,{prop:"password",label:"密码"},{default:l(()=>[r(a,{modelValue:o.value.password,"onUpdate:modelValue":e[1]||(e[1]=t=>o.value.password=t),type:"password",placeholder:"请输入密码","show-password":""},null,8,["modelValue"])]),_:1}),r(i,{prop:"confirmPassword",label:"确认密码"},{default:l(()=>[r(a,{modelValue:o.value.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.confirmPassword=t),type:"password",placeholder:"请再次输入密码"},null,8,["modelValue"])]),_:1}),f(v).verify_code_is_open===1?(c(),b(i,{key:0,prop:"authCode",label:"验证码"},{default:l(()=>[r(a,{modelValue:o.value.authCode,"onUpdate:modelValue":e[4]||(e[4]=t=>o.value.authCode=t),placeholder:"请输入验证码"},{suffix:l(()=>[r(s,{class:"code-btn",disabled:_.value,type:"primary",onClick:e[3]||(e[3]=z(t=>M(t),["stop"]))},{default:l(()=>e[8]||(e[8]=[y(" 发送验证码 ")])),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1})):G("",!0)]),_:1},8,["model"])),[[x,d.value]]),B((c(),b(s,{class:"sign-btn",type:"primary",onClick:L},{default:l(()=>e[9]||(e[9]=[y(" 立即注册 ")])),_:1})),[[x,d.value]]),J("div",oe,[r(s,{type:"primary",link:"",onClick:e[5]||(e[5]=t=>f(k).push("/login"))},{default:l(()=>e[10]||(e[10]=[y("已有账号，去登录！")])),_:1})])]),_:1},8,["modelValue","show-close"]),r(ee,{ref_key:"payBtnRef",ref:E,type:"pay-agent",info:{}},null,512)])}}});const Je=Y(te,[["__scopeId","data-v-71ec65e8"]]);export{Je as default};
