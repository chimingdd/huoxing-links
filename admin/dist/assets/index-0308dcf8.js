import{u as J}from"./curd-590e7fca.js";import{_ as k}from"./FormModal.vue_vue_type_script_setup_true_lang-b27420e1.js";import{l as N,_ as O}from"./index-31481636.js";import Q from"./user-action-c76ab5da.js";import R from"./create-or-look-3dacd0a1.js";import{d as W,j as u,r as s,X as Z,o as d,b as h,i as e,w as l,g as t,l as m,f as ee,ah as te,Y as le,a as _,ai as S,t as U,h as C,F as ae,E as D}from"./.pnpm-9b0f0a98.js";import oe from"./agent-commission-1cbe76db.js";import"./propData-3c6625bc.js";import"./form-e5ba5cf1.js";import"./super-d6a4fee1.js";const ie={class:"header-right"},ne={key:0},re={key:1},se=W({__name:"index",setup(de){const{state:o,showForm:$,submitForm:E,research:q,sizeChangeHandle:A,currentChangeHandle:I}=J({url:"/users",queryForm:{page:1,type:2}}),x=n=>{N(n.id,{status:!n.status}).then(()=>{D.success("操作成功！"),window.location.reload()})},g=u(!1),w=u(),f=u(),v=u(),F=(n,i)=>{g.value=!0,w.value=n,f.value=i,i=="level_id"?v.value="更改等级":i=="credit"?v.value="充值积分":i=="parent_id"&&(v.value="更改级别")},L=(n,i)=>{var p={};f.value=="level_id"?p={level_id:n.level_id}:f.value=="credit"?p={credit:n.credit}:f.value=="parent_id"&&(p={parent_id:n.parent_id}),N(i.id,p).then(()=>{D.success("操作成功！"),window.location.reload()})},y=u(!1),V=u(),H=n=>{console.log(n),y.value=!0,V.value=n};return(n,i)=>{var B;const p=s("el-input"),P=s("el-form-item"),z=s("el-col"),c=s("el-button"),T=s("el-row"),j=s("el-form"),r=s("el-table-column"),K=s("el-empty"),M=s("el-table"),X=s("el-pagination"),Y=s("el-card"),G=Z("loading");return d(),h(ae,null,[e(Y,null,{default:l(()=>[e(j,null,{default:l(()=>[e(T,{gutter:20},{default:l(()=>[e(z,{span:4},{default:l(()=>[e(P,null,{default:l(()=>[e(p,{modelValue:t(o).queryForm.username,"onUpdate:modelValue":i[0]||(i[0]=a=>t(o).queryForm.username=a),placeholder:"请输入手机号",style:{width:"260px"},clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(z,{span:4},{default:l(()=>[e(c,{type:"primary",onClick:t(q)},{default:l(()=>[m("查询")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),ee("div",ie,[e(c,{type:"primary",icon:t(te),onClick:t($)},{default:l(()=>[m("新增代理")]),_:1},8,["icon","onClick"])]),le((d(),_(M,{data:t(o).dataList,"header-cell-style":{"text-align":"center","background-color":"#F1F1F1",height:"50px",color:"#333"},"cell-style":{padding:"0","text-align":"center",height:"50px",color:"#333"},"row-key":t(o).primaryKey},{empty:l(()=>[e(K)]),default:l(()=>[e(r,{prop:"id",label:"ID",width:"60"}),e(r,{prop:"username",label:"手机号",width:"120"}),e(r,{prop:"agent_package.name",label:"当前套餐"}),e(r,{prop:"credit",label:"剩余积分"},{default:l(({row:a})=>[e(c,{type:"primary",link:"",icon:t(S),onClick:b=>F(a,"credit")},{default:l(()=>[m(U(a.credit),1)]),_:2},1032,["icon","onClick"])]),_:1}),e(r,{prop:"accumulate_credit",label:"累计充值积分"}),e(r,{prop:"commission",label:"剩余佣金",width:"120"}),e(r,{prop:"accumulate_commission",label:"累计佣金",width:"120"}),e(r,{prop:"referral_code",label:"推荐码"}),e(r,{prop:"parent.username",label:"上级"},{default:l(({row:a})=>[e(c,{type:"primary",link:"",icon:t(S),onClick:b=>F(a,"parent_id")},{default:l(()=>[a.parent&&a.parent.username?(d(),h("span",ne,U(a.parent.username),1)):(d(),h("span",re))]),_:2},1032,["icon","onClick"])]),_:1}),e(r,{prop:"created_at",label:"注册时间",width:"160"}),e(r,{prop:"",label:"操作",fixed:"right",width:"200"},{default:l(({row:a})=>[a.status?(d(),_(c,{key:0,type:"primary",link:"",onClick:b=>x(a)},{default:l(()=>[m("禁用")]),_:2},1032,["onClick"])):(d(),_(c,{key:1,type:"primary",link:"",onClick:b=>x(a),style:{color:"#ff0000"}},{default:l(()=>[m("启用")]),_:2},1032,["onClick"])),e(c,{type:"primary",link:"",onClick:b=>H(a.id)},{default:l(()=>[m("佣金记录")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","row-key"])),[[G,t(o).listLoading]]),e(X,{"current-page":t(o).page,total:t(o).total,"page-sizes":t(o).pageSizes,"page-size":t(o).limit,background:"",layout:"total, sizes, prev, pager, next",onSizeChange:t(A),onCurrentChange:t(I)},null,8,["current-page","total","page-sizes","page-size","onSizeChange","onCurrentChange"])]),_:1}),t(o).formVisible===!0?(d(),_(k,{key:0,visible:t(o).formVisible,"onUpdate:visible":i[1]||(i[1]=a=>t(o).formVisible=a),loading:t(o).formLoading,detail:t(o).detailData,onSubmit:t(E),type:"dialog",width:"600",title:(B=t(o).detailData)!=null&&B.id?"编辑":"新增",cancelBtnName:"取消",okBtnName:"确定"},{default:l(()=>[e(R)]),_:1},8,["visible","loading","detail","onSubmit","title"])):C("",!0),g.value?(d(),_(k,{key:1,visible:g.value,"onUpdate:visible":i[2]||(i[2]=a=>g.value=a),detail:w.value,onSubmit:L,type:"dialog",width:"600",title:v.value,cancelBtnName:"取消",okBtnName:"确定"},{default:l(()=>[e(Q,{"form-feild":f.value},null,8,["form-feild"])]),_:1},8,["visible","detail","title"])):C("",!0),y.value?(d(),_(k,{key:2,visible:y.value,"onUpdate:visible":i[3]||(i[3]=a=>y.value=a),type:"drawer_v",width:"900",title:"佣金记录"},{default:l(()=>[e(oe,{user_id:V.value},null,8,["user_id"])]),_:1},8,["visible"])):C("",!0)],64)}}});const ke=O(se,[["__scopeId","data-v-65891fa0"]]);export{ke as default};
