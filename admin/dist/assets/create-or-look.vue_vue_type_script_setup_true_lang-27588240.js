import{u as R}from"./form-3c660157.js";import{S as q}from"./@element-plus-11e7d0b3.js";import{u as B,O as E,_ as F}from"./index-eb0483c8.js";import{g as S,E as k}from"./element-plus-baf202ae.js";import{d as C,r,j,ag as u,o as p,c as L,Q as n,I as i,u as c,H as I,L as D,b as O,aq as P,J as $,a5 as A,P as H}from"./@vue-d872a633.js";import{a as N}from"./app-bf1cc552.js";const T={class:"upload-box"},J=C({__name:"uploadImg",props:{modelValue:{},type:{},size:{},width:{},height:{},action:{default:"/api/material-upload"}},emits:["update:modelValue"],setup(z,{emit:_}){const t=_,o=z,m=r(),f=r(),s=r(!1),d=r(!1),e=r(),g=a=>{e.value=a.response.path,d.value=!0},h={Authorization:"Bearer "+B.getToken()},V=()=>{t("update:modelValue",[])};j("query");const v=a=>{m.value.clearFiles();const l=a[0];l.uid=S(),m.value.handleStart(l)},y=a=>{if(o.type&&o.type.length>0||o.size){s.value=!0,console.log(a.size,"rawFile.size");const l=a.size<1024*1024*o.size,x=o.type.indexOf(a.type)>-1;if(!l)return k.warning(`图片大小不超过${o.size}M`),s.value=!1,!1;if(!x)return k.warning(`图片只能是${o.type.join(",")}格式!`),s.value=!1,!1}else return!0},b=a=>{s.value=!0,setTimeout(()=>{t("update:modelValue",a),k.success("上传成功"),s.value=!1},1e3)};return(a,l)=>{const x=u("el-icon"),U=u("el-upload"),M=u("el-dialog");return p(),L("div",T,[n(U,{ref_key:"uploadRef",ref:m,"file-list":f.value,"onUpdate:fileList":l[0]||(l[0]=w=>f.value=w),action:o.action,headers:h,name:"image",limit:1,class:"avatar-warp","on-exceed":v,"before-upload":y,"on-success":b,"on-preview":g,"on-remove":V},{default:i(()=>[n(x,null,{default:i(()=>[n(c(q))]),_:1})]),_:1},8,["file-list","action"]),n(M,{modelValue:d.value,"onUpdate:modelValue":l[1]||(l[1]=w=>d.value=w)},{default:i(()=>[e.value?(p(),I(E,{key:0,height:200,width:200,paths:[e.value]},null,8,["paths"])):D("",!0)]),_:1},8,["modelValue"])])}}});const Q=F(J,[["__scopeId","data-v-9acc117d"]]),ee=C({__name:"create-or-look",setup(z){const _=r(),{formData:t,formLoading:o}=R({formRef:_,defVal(e){return{cate_id:e==null?void 0:e.cate_id,image:e==null?void 0:e.image,name:e==null?void 0:e.name}}}),m={cate_id:[{required:!0,message:"请选择分类",trigger:"blur"}],image:[{required:!0,message:"请上传图片",trigger:"blur"}]},f=e=>{t.value.image=e.path,t.value.name=e.name},s=r(),d=async()=>{s.value=await N()};return O(()=>{d()}),(e,g)=>{const h=u("el-option"),V=u("el-select"),v=u("el-form-item"),y=u("el-form"),b=P("loading");return $((p(),I(y,{model:c(t),rules:m,ref_key:"formRef",ref:_,"label-width":"120px"},{default:i(()=>[n(v,{prop:"name",label:"分类",style:{width:"370px"}},{default:i(()=>[n(V,{modelValue:c(t).cate_id,"onUpdate:modelValue":g[0]||(g[0]=a=>c(t).cate_id=a),clearable:"",placeholder:"请选择"},{default:i(()=>[(p(!0),L(H,null,A(s.value,a=>(p(),I(h,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(v,{label:"图片"},{default:i(()=>[n(Q,{"model-value":c(t).image,"onUpdate:modelValue":f},null,8,["model-value"])]),_:1})]),_:1},8,["model"])),[[b,c(o)]])}}});export{ee as _};
